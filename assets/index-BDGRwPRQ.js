(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();const A=30,I=10,q=6e4,L=3e4,S=.1,_={p1:.1,p2:.15,p3:.2,p4:.05,p5:.25},N="flex justify-between items-center mb-2",g="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1",b="remove-item bg-red-500 text-white px-2 py-1 rounded",D="text-green-500 ml-2",O="text-blue-500 ml-2",U="productId",M="change",d="x ",c={prodList:[{id:"p1",name:"상품1",val:1e4,q:50},{id:"p2",name:"상품2",val:2e4,q:30},{id:"p3",name:"상품3",val:3e4,q:20},{id:"p4",name:"상품4",val:15e3,q:0},{id:"p5",name:"상품5",val:25e3,q:10}],lastSelectedProductId:null,bonusPoints:0,finalPaymentAmount:0,cartAllItemCount:0},R=(e,t)=>e*(1-t),B=()=>new Date().getDay()===2,C=(e,t)=>e.find(n=>n.id===t),y=(e,t=d)=>parseInt(e.split(t)[1],10),v=(e,t,n=d)=>y(e,n)+t,P=(e,t,n,s=d)=>`${e} - ${t}원 ${s}${n}`,w=(e,t)=>e*t,H=(e,t)=>e-t,Q=(e,t,n,s)=>{const o=w(t,n),a=H(e,t),l=o>a;return{price:l?e*(1-n):t,rate:l?n:a/e}},$=(e,t,n)=>e>0&&e<=t+n,E=()=>{const e=r.select;r.select&&(e.innerHTML=""),c.prodList.forEach(t=>{const n=document.createElement("option");n.value=t.id,n.textContent=t.name+" - "+t.val+"원",t.q===0&&(n.disabled=!0),e.appendChild(n)})},k=()=>{c.bonusPoints=Math.floor(c.finalPaymentAmount/1e3);let e=document.getElementById("loyalty-points");e||(e=document.createElement("span"),e.id="loyalty-points",e.className=O,u.appendChild(e)),e.textContent="(포인트: "+c.bonusPoints+")"},Y=()=>{let e="";c.prodList.forEach(t=>{t.q<5&&(e+=t.name+": "+(t.q>0?"재고 부족 ("+t.q+"개 남음)":"품절")+`
`)}),f.textContent=e};function T(){c.finalPaymentAmount=0,c.cartAllItemCount=0;const e=p.children;let t=0;for(const s of e){const o=s.id,a=C(c.prodList,o),l=y(s.querySelector("span").textContent,d),i=a.val*l,x=l>=I&&_[a.id]||0;c.cartAllItemCount+=l,t+=i,c.finalPaymentAmount+=R(i,x)}let n=0;if(c.cartAllItemCount>=A){const{price:s,rate:o}=Q(t,c.finalPaymentAmount,A);c.finalPaymentAmount=s,n=o}else n=(t-c.finalPaymentAmount)/t;if(B()&&(c.finalPaymentAmount*=1-S,n=Math.max(n,S)),u.textContent="총액: "+Math.round(c.finalPaymentAmount)+"원",n>0){const s=document.createElement("span");s.className=D,s.textContent="("+(n*100).toFixed(1)+"% 할인 적용)",u.appendChild(s)}Y(),k()}const G=()=>{const e=r.select.value,t=C(c.prodList,e);if(t&&t.q>0){const n=document.getElementById(t.id);if(n&&n!==null){const s=v(n.querySelector("span").textContent,1,d);if(s<=t.q){const o=n.querySelector("span");o?o.textContent=P(t.name,t.val,s,d):console.error("Span element not found for item:",t.id),t.q--}else alert("재고가 부족합니다.")}else{const s=document.createElement("div");s.id=t.id,s.className=N,s.innerHTML=`<span>${P(t.name,t.val,1,d)}</span><div><button class="${g}" data-product-id="`+t.id+`" data-change="-1">-</button><button class="${g}" data-product-id="`+t.id+`" data-change="1">+</button><button class="${b}" data-product-id="`+t.id+'">삭제</button></div>',p.appendChild(s),t.q--}T(),c.lastSelectedProductId=e}},K=e=>{var n;const t=e.target;if(t instanceof HTMLElement&&t.classList.contains("quantity-change")||t instanceof HTMLElement&&t.classList.contains("remove-item")){const s=t.dataset[U],o=s?document.getElementById(s):null,a=C(c.prodList,s);if(t.classList.contains("quantity-change")&&a&&o&&((n=o.querySelector("span"))!=null&&n.textContent)){const l=parseInt(t.dataset[M]||"0"),i=v(o.querySelector("span").textContent,l,d);$(i,a.q,y(o.querySelector("span").textContent,d))?(o.querySelector("span").textContent=P(a.name,a.val,i,d),a.q-=l):i<=0?(o.remove(),a.q-=l):alert("재고가 부족합니다.")}else if(t.classList.contains("remove-item")){const l=y(o.querySelector("span").textContent,d);a.q+=l,o.remove()}T()}},r={select:null,addCartButton:null,cartDisplay:null,totalDisplay:null,stockStatus:null},p=r.cartDisplay=document.createElement("div"),u=r.totalDisplay=document.createElement("div"),h=r.select=document.createElement("select"),m=r.addCartButton=document.createElement("button"),f=r.stockStatus=document.createElement("div"),V=()=>{const e=c.prodList=[{id:"p1",name:"상품1",val:1e4,q:50},{id:"p2",name:"상품2",val:2e4,q:30},{id:"p3",name:"상품3",val:3e4,q:20},{id:"p4",name:"상품4",val:15e3,q:0},{id:"p5",name:"상품5",val:25e3,q:10}],t=document.getElementById("app"),n=document.createElement("div"),s=document.createElement("div"),o=document.createElement("h1");p.id="cart-items",u.id="cart-total",h.id="product-select",m.id="add-to-cart",f.id="stock-status",n.className="bg-gray-100 p-8",s.className="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8",o.className="text-2xl font-bold mb-4",u.className="text-xl font-bold my-4",h.className="border rounded p-2 mr-2",m.className="bg-blue-500 text-white px-4 py-2 rounded",f.className="text-sm text-gray-500 mt-2",o.textContent="장바구니",m.textContent="추가",s.appendChild(o),s.appendChild(p),s.appendChild(u),s.appendChild(h),s.appendChild(m),s.appendChild(f),n.appendChild(s),t?t.appendChild(n):console.error("Element with ID 'app' not found in the DOM."),setTimeout(()=>{setInterval(()=>{const a=e[Math.floor(Math.random()*e.length)];Math.random()<.3&&a.q>0&&(a.val=Math.round(a.val*.8),alert("번개세일! "+a.name+"이(가) 20% 할인 중입니다!"),E())},L)},Math.random()*10),setTimeout(()=>{setInterval(()=>{if(c.lastSelectedProductId){const a=C(e,c.lastSelectedProductId);a&&(alert(a.name+"은(는) 어떠세요? 지금 구매하시면 5% 추가 할인!"),a.val=Math.round(a.val*.95),E())}},q)},Math.random()*20),m.addEventListener("click",()=>G()),p.addEventListener("click",a=>K(a)),E(),T()};V();
